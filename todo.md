# 計算機アプリケーション 実装 TODO リスト

## フェーズ 1: 基本入力機能の実装

### 1.1 数字入力機能

- [ ] 数字ボタン（0-9）のクリックで数値を入力できるようにする
- [ ] 初期状態（"0"）の時は、数字を押すと置き換える（"0" → "1"）
- [ ] 既に数値が入力されている場合は、末尾に追加する（"12" → "123"）
- [ ] 状態管理：現在の入力値を保持する state を適切に更新する

### 1.2 表示の更新

- [ ] 入力された数値が Display コンポーネントに正しく表示されることを確認
- [ ] 長い数値が表示領域を超える場合の処理（オーバーフロー対応は後回しでも可）

## フェーズ 2: 四則演算の基本ロジック

### 2.1 演算子の状態管理

- [ ] 現在選択されている演算子（+, -, ×, ÷）を保持する state を追加
- [ ] 演算子ボタンをクリックした時に、選択された演算子を保存する
- [ ] 演算子が選択された時に、現在の入力値を「前の値」として保存する

### 2.2 演算子の切り替え

- [ ] 既に演算子が選択されている状態で別の演算子を押した場合、演算子を切り替える
- [ ] 演算子を切り替えた後、新しい数値の入力待ち状態にする

## フェーズ 3: 等号による計算実行

### 3.1 計算ロジックの実装

- [ ] 等号ボタンをクリックした時に、前の値と現在の値、演算子を使って計算を実行
- [ ] 四則演算（+, -, ×, ÷）それぞれの計算処理を実装
- [ ] 計算結果を Display に表示する
- [ ] 計算後、結果を「前の値」として保持し、連続計算に備える

### 3.2 連続計算の対応

- [ ] 計算結果が表示された状態で、演算子を押すと連続計算が可能になる
- [ ] 計算結果が表示された状態で、数字を押すと新しい計算を開始する

## フェーズ 4: クリア機能の実装

### 4.1 C（Clear）ボタン

- [ ] C ボタンをクリックした時に、現在の入力値を"0"にリセット
- [ ] 演算子や前の値は保持したまま、現在の表示のみをクリア

### 4.2 AC（All Clear）ボタン

- [ ] AC ボタンをクリックした時に、すべての状態を初期化
- [ ] 表示値、演算子、前の値、計算履歴などをすべてリセット

## フェーズ 5: 小数点入力の実装

### 5.1 小数点の入力制御

- [ ] 小数点ボタン（.）をクリックした時に、小数点を追加する
- [ ] 既に小数点が含まれている数値には、重複して小数点を追加しない
- [ ] 整数値の末尾に小数点を追加する処理（例："123" → "123."）

### 5.2 小数点の表示

- [ ] 小数点を含む数値が正しく表示されることを確認
- [ ] 小数点のみの入力（"." → "0."）の処理

## フェーズ 6: 連続計算と演算子変更の改善

### 6.1 演算子の変更時の挙動

- [ ] 演算子を変更した時に、前回の計算結果を保持する
- [ ] 演算子を変更した後、新しい数値の入力待ち状態にする

### 6.2 計算フローの最適化

- [ ] 等号を押さずに演算子を連続で押した場合の挙動を定義
- [ ] 計算の優先順位や連続計算の挙動を統一する

## フェーズ 7: エラーハンドリング

### 7.1 ゼロ除算の処理

- [ ] 割り算（÷）で 0 で割ろうとした場合、エラーメッセージを表示
- [ ] エラー状態を管理する state を追加
- [ ] エラー表示後、AC ボタンでリセットできるようにする

### 7.2 その他のエラー処理

- [ ] 計算結果が無限大や NaN になった場合の処理
- [ ] 数値が大きすぎる場合の処理（オーバーフロー）
- [ ] エラー状態の表示方法を定義（例："Error"と表示）

## フェーズ 8: 追加機能の実装

### 8.1 バックスペース（⌫）機能

- [ ] バックスペースボタンをクリックした時に、最後の文字を削除
- [ ] 最後の 1 文字を削除した後、空になった場合は"0"を表示
- [ ] 小数点のみが残った場合の処理（例："12." → "12"）

### 8.2 符号反転（±）機能

- [ ] 符号反転ボタンをクリックした時に、現在の数値の正負を切り替える
- [ ] 正の数は負の数に、負の数は正の数に変換
- [ ] "0"の場合は符号を変更しない（または変更しても問題ない）

### 8.3 パーセント（%）機能

- [ ] パーセントボタンをクリックした時に、現在の数値を 100 で割る
- [ ] パーセント計算の結果を表示
- [ ] パーセント計算後の連続計算の挙動を定義

## フェーズ 9: UI/UX の改善

### 9.1 入力フィードバック

- [ ] ボタンを押した時の視覚的フィードバック（既に active:scale-95 は実装済み）
- [ ] 演算子が選択されている状態の視覚的表示（オプション）

### 9.2 表示の改善

- [ ] 長い数値の表示方法（フォントサイズの調整、スクロール対応など）
- [ ] 計算結果のフォーマット（小数点以下の桁数制限など）

### 9.3 キーボード入力対応（オプション）

- [ ] キーボードから数字や演算子を入力できるようにする
- [ ] Enter キーで等号を実行
- [ ] Escape キーで AC（全クリア）を実行

## 実装の優先順位

1. **最優先（基本機能）**: フェーズ 1, 2, 3, 4, 5
2. **重要（使いやすさ）**: フェーズ 6, 7
3. **追加機能**: フェーズ 8
4. **改善（余裕があれば）**: フェーズ 9

## 実装時の注意点

- 各フェーズを完了したら、動作確認を必ず行う
- 状態管理が複雑になるため、state の構造を最初に設計する
- 計算ロジックは別の関数として分離し、テストしやすくする
- エッジケース（例：小数点の重複、ゼロ除算など）を考慮する
- 連続計算の挙動は、一般的な計算機の動作を参考にする
